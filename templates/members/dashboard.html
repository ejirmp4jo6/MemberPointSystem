{% extends "base.html" %}
{% block title %}我的點數{% endblock %}
{% block content %}
<div class="row g-3">
  <div class="col-lg-5">
    <div class="cardish">
      <div class="d-flex justify-content-between align-items-center">
        <h6 class="mb-2">我的點數</h6>
        <span class="badge-soft">一般會員</span>
      </div>
      <div class="kpi mb-3">{{ member.points }}</div>
      <hr>
      <h6 class="mb-2">會員條碼</h6>
      <img src="{% url 'barcode_image' %}" alt="barcode" class="img-fluid" style="max-width:320px">
      <p class="text-muted small mt-2">條碼值：{{ member.barcode_token }}</p>
    </div>
  </div>
  <div class="col-lg-7">
    <div class="cardish">
      <div class="d-flex justify-content-between align-items-center mb-2">
        <h6 class="mb-0">最近交易</h6>
      </div>
      <div class="table-responsive">
        <table class="table table-clean align-middle">
          <thead><tr><th>時間</th><th>說明</th><th class="text-end">點數</th></tr></thead>
          <tbody>
            {% for t in txns %}
            <tr>
              <td>{{ t.created_at|date:"Y-m-d H:i" }}</td>
              <td class="text-muted">{{ t.note }}</td>
              <td class="text-end">
                <strong class="{% if t.amount > 0 %}text-success{% else %}text-danger{% endif %}">
                  {% if t.amount > 0 %}+{% endif %}{{ t.amount }}
                </strong>
              </td>
            </tr>
            {% empty %}
            <tr><td colspan="3" class="text-muted">尚無交易</td></tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
{% endblock %}
